<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>Student Results</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <style>body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f9f9fb;
    padding: 20px;
    animation: fadeIn 0.6s ease-in;
}

select {
    margin-bottom: 16px;
    padding: 8px;
    font-size: 1rem;
}

table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

th,
td {
    padding: 14px;
    border: 1px solid #eee;
    text-align: center;
}

img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
}

.modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: none;
    background: rgba(0,0,0,0.6);
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.modal-content {
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    text-align: left;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}</style>
    </head>
    <body>
        <h2>Student Results</h2>
        <select id="class-select"></select>
        <table>
            <thead>
                <tr>
                    <th>Photo</th>
                    <th>Roll No</th>
                    <th>Name</th>
                    <th>Marks</th>
                </tr>
            </thead>
            <tbody id="results-body"></tbody>
        </table>
        <div class="modal" id="marks-modal">
            <div class="modal-content">
                <h3 id="modal-name"></h3>
                <p><strong>Roll No:</strong> <span id="modal-roll"></span></p>
                <div id="modal-marks"></div>
                <button onclick="closeModal()">Close</button>
            </div>
        </div>
        <script>
    const endpoint = 'https://script.google.com/macros/s/AKfycbxorHUsoZUuaMluss3-LfqiYPDqRMIt5rNmVDS1Q9zRhv8sfsfgOqwsTY15XO5BcKZbkQ/exec';
    const classes = ['Class_10_A','Class_10_B','Class_10_C','Class_10_D','Class_11_A','Class_11_B','Class_11_C','Class_11_D','Class_12_A','Class_12_B','Class_12_C','Class_12_D'];

    const classSelect = document.getElementById('class-select');
    const resultsBody = document.getElementById('results-body');

    const modal = document.getElementById('marks-modal');
    const modalName = document.getElementById('modal-name');
    const modalRoll = document.getElementById('modal-roll');
    const modalMarks = document.getElementById('modal-marks');

    classes.forEach(cls => {
      classSelect.innerHTML += `<option value="${cls}">${cls}</option>`;
    });

    classSelect.onchange = async () => {
      const res = await fetch(`${endpoint}?action=getAllStudents&class=${classSelect.value}`);
      const data = await res.json();
      renderTable(data);
    };

    function renderTable(data) {
      resultsBody.innerHTML = '';
      data.forEach(st => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><img src="${st.photoUrl}" /></td>
          <td>${st.rollNo}</td>
          <td>${st.name}</td>
          <td><button onclick='showMarks(${JSON.stringify(st.subjects)}, "${st.name}", "${st.rollNo}")'>View</button></td>`;
        resultsBody.appendChild(tr);
      });
    }

    function showMarks(subjects, name, roll) {
      modalName.textContent = name;
      modalRoll.textContent = roll;
      modalMarks.innerHTML = subjects.map(s => `<p>${s.subject}: ${s.marks}</p>`).join('');
      modal.style.display = 'flex';
    }

    function closeModal() {
      modal.style.display = 'none';
    }
  </script>
    </body>
</html>
